{"ast":null,"code":"export function uploadShortcut(shortcut, filename, onProgress) {\n  return new Promise(function (resolve) {\n    var formdata = new FormData();\n    formdata.append(\"file\", new Blob([shortcut], {\n      type: \"application/x-octet-stream\"\n    }), filename);\n    var xhttp = new XMLHttpRequest();\n    xhttp.open(\"POST\", \"https://file.io\", true);\n\n    xhttp.onprogress = function (e) {\n      if (e.lengthComputable) {\n        onProgress && onProgress(e.loaded / e.total);\n      } else {\n        onProgress && onProgress(0.1);\n      }\n    };\n\n    xhttp.onerror = function () {\n      resolve({\n        result: \"error\",\n        message: \"An error occured. This may be because you do not have internet access or because the file.io servers were unreachable.\"\n      });\n    };\n\n    xhttp.onreadystatechange = function () {\n      if (xhttp.readyState === 4) {\n        onProgress && onProgress(1); // Typical action to be performed when the document is ready:\n\n        if (xhttp.response) {\n          var result = JSON.parse(xhttp.response);\n\n          if (!result.success) {\n            resolve({\n              result: \"error\",\n              message: \"The file could not be uploaded. Error: \".concat(result.message)\n            });\n          } else {\n            resolve({\n              result: \"success\",\n              url: result.link\n            });\n          }\n        }\n      }\n    };\n\n    xhttp.send(formdata);\n  });\n}\nexport function downloadShortcut(id, onProgress) {\n  return new Promise(function (resolve) {\n    var xhttp = new XMLHttpRequest();\n    xhttp.open(\"GET\", \"https://shortcutsweb.app/inspectshortcut?id=\".concat(encodeURIComponent(id)), true);\n    xhttp.responseType = \"arraybuffer\";\n\n    xhttp.onprogress = function (e) {\n      if (e.lengthComputable) {\n        onProgress && onProgress(e.loaded / e.total);\n      } else {\n        onProgress && onProgress(0.1);\n      }\n    };\n\n    xhttp.onerror = function () {\n      resolve({\n        result: \"error\",\n        message: \"An error occured. This may be because you do not have internet access or because the shortcutsweb.app servers are unreachable.\"\n      });\n    };\n\n    xhttp.onreadystatechange = function () {\n      if (xhttp.readyState === 4) {\n        onProgress && onProgress(1); // Typical action to be performed when the document is ready:\n\n        if (xhttp.response) {\n          var result = xhttp.response;\n\n          if (xhttp.status === 200) {\n            return resolve({\n              result: \"success\",\n              shortcut: result\n            });\n          }\n\n          return resolve({\n            result: \"error\",\n            message: \"There was an error getting your shortcut data. Maybe you entered the wrong URL? Additional information: Error \".concat(xhttp.status, \": \").concat(xhttp.statusText, \": \").concat(Buffer.from(result).toString(\"utf-8\"))\n          });\n        }\n      }\n    };\n\n    xhttp.send();\n  });\n}","map":{"version":3,"sources":["/Users/brandonjordan/Documents/GitHub/scpl-editor/src/Uploader.ts"],"names":["uploadShortcut","shortcut","filename","onProgress","Promise","resolve","formdata","FormData","append","Blob","type","xhttp","XMLHttpRequest","open","onprogress","e","lengthComputable","loaded","total","onerror","result","message","onreadystatechange","readyState","response","JSON","parse","success","url","link","send","downloadShortcut","id","encodeURIComponent","responseType","status","statusText","Buffer","from","toString"],"mappings":"AASA,OAAO,SAASA,cAAT,CACNC,QADM,EAENC,QAFM,EAGNC,UAHM,EAML;AACD,SAAO,IAAIC,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC7B,QAAMC,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,IAAAA,QAAQ,CAACE,MAAT,CACC,MADD,EAEC,IAAIC,IAAJ,CAAS,CAACR,QAAD,CAAT,EAAqB;AAAES,MAAAA,IAAI,EAAE;AAAR,KAArB,CAFD,EAGCR,QAHD;AAMA,QAAMS,KAAK,GAAG,IAAIC,cAAJ,EAAd;AACAD,IAAAA,KAAK,CAACE,IAAN,CAAW,MAAX,EAAmB,iBAAnB,EAAsC,IAAtC;;AAEAF,IAAAA,KAAK,CAACG,UAAN,GAAmB,UAAAC,CAAC,EAAI;AACvB,UAAIA,CAAC,CAACC,gBAAN,EAAwB;AACvBb,QAAAA,UAAU,IAAIA,UAAU,CAACY,CAAC,CAACE,MAAF,GAAWF,CAAC,CAACG,KAAd,CAAxB;AACA,OAFD,MAEO;AACNf,QAAAA,UAAU,IAAIA,UAAU,CAAC,GAAD,CAAxB;AACA;AACD,KAND;;AAOAQ,IAAAA,KAAK,CAACQ,OAAN,GAAgB,YAAM;AACrBd,MAAAA,OAAO,CAAC;AACPe,QAAAA,MAAM,EAAE,OADD;AAEPC,QAAAA,OAAO,EACN;AAHM,OAAD,CAAP;AAKA,KAND;;AAOAV,IAAAA,KAAK,CAACW,kBAAN,GAA2B,YAAM;AAChC,UAAIX,KAAK,CAACY,UAAN,KAAqB,CAAzB,EAA4B;AAC3BpB,QAAAA,UAAU,IAAIA,UAAU,CAAC,CAAD,CAAxB,CAD2B,CAE3B;;AACA,YAAIQ,KAAK,CAACa,QAAV,EAAoB;AACnB,cAAMJ,MAAoB,GAAGK,IAAI,CAACC,KAAL,CAAWf,KAAK,CAACa,QAAjB,CAA7B;;AACA,cAAI,CAACJ,MAAM,CAACO,OAAZ,EAAqB;AACpBtB,YAAAA,OAAO,CAAC;AACPe,cAAAA,MAAM,EAAE,OADD;AAEPC,cAAAA,OAAO,mDACND,MAAM,CAACC,OADD;AAFA,aAAD,CAAP;AAMA,WAPD,MAOO;AACNhB,YAAAA,OAAO,CAAC;AAAEe,cAAAA,MAAM,EAAE,SAAV;AAAqBQ,cAAAA,GAAG,EAAER,MAAM,CAACS;AAAjC,aAAD,CAAP;AACA;AACD;AACD;AACD,KAlBD;;AAoBAlB,IAAAA,KAAK,CAACmB,IAAN,CAAWxB,QAAX;AACA,GA9CM,CAAP;AA+CA;AAED,OAAO,SAASyB,gBAAT,CACNC,EADM,EAEN7B,UAFM,EAML;AACD,SAAO,IAAIC,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC7B,QAAMM,KAAK,GAAG,IAAIC,cAAJ,EAAd;AACAD,IAAAA,KAAK,CAACE,IAAN,CACC,KADD,wDAEgDoB,kBAAkB,CAChED,EADgE,CAFlE,GAKC,IALD;AAOArB,IAAAA,KAAK,CAACuB,YAAN,GAAqB,aAArB;;AAEAvB,IAAAA,KAAK,CAACG,UAAN,GAAmB,UAAAC,CAAC,EAAI;AACvB,UAAIA,CAAC,CAACC,gBAAN,EAAwB;AACvBb,QAAAA,UAAU,IAAIA,UAAU,CAACY,CAAC,CAACE,MAAF,GAAWF,CAAC,CAACG,KAAd,CAAxB;AACA,OAFD,MAEO;AACNf,QAAAA,UAAU,IAAIA,UAAU,CAAC,GAAD,CAAxB;AACA;AACD,KAND;;AAOAQ,IAAAA,KAAK,CAACQ,OAAN,GAAgB,YAAM;AACrBd,MAAAA,OAAO,CAAC;AACPe,QAAAA,MAAM,EAAE,OADD;AAEPC,QAAAA,OAAO,EACN;AAHM,OAAD,CAAP;AAKA,KAND;;AAOAV,IAAAA,KAAK,CAACW,kBAAN,GAA2B,YAAM;AAChC,UAAIX,KAAK,CAACY,UAAN,KAAqB,CAAzB,EAA4B;AAC3BpB,QAAAA,UAAU,IAAIA,UAAU,CAAC,CAAD,CAAxB,CAD2B,CAE3B;;AACA,YAAIQ,KAAK,CAACa,QAAV,EAAoB;AACnB,cAAMJ,MAAmB,GAAGT,KAAK,CAACa,QAAlC;;AACA,cAAIb,KAAK,CAACwB,MAAN,KAAiB,GAArB,EAA0B;AACzB,mBAAO9B,OAAO,CAAC;AAAEe,cAAAA,MAAM,EAAE,SAAV;AAAqBnB,cAAAA,QAAQ,EAAEmB;AAA/B,aAAD,CAAd;AACA;;AACD,iBAAOf,OAAO,CAAC;AACde,YAAAA,MAAM,EAAE,OADM;AAEdC,YAAAA,OAAO,0HACNV,KAAK,CAACwB,MADA,eAEFxB,KAAK,CAACyB,UAFJ,eAEmBC,MAAM,CAACC,IAAP,CAAYlB,MAAZ,EAAoBmB,QAApB,CACzB,OADyB,CAFnB;AAFO,WAAD,CAAd;AAQA;AACD;AACD,KAnBD;;AAqBA5B,IAAAA,KAAK,CAACmB,IAAN;AACA,GA/CM,CAAP;AAgDA","sourcesContent":["type UploadResult =\n\t| {\n\t\t\tsuccess: true;\n\t\t\tkey: string;\n\t\t\tlink: string;\n\t\t\texpiry: string;\n\t  }\n\t| { success: false; error: number; message: string };\n\nexport function uploadShortcut(\n\tshortcut: Buffer,\n\tfilename: string,\n\tonProgress?: (percent: number) => void\n): Promise<\n\t{ result: \"success\"; url: string } | { result: \"error\"; message: string }\n> {\n\treturn new Promise(resolve => {\n\t\tconst formdata = new FormData();\n\t\tformdata.append(\n\t\t\t\"file\",\n\t\t\tnew Blob([shortcut], { type: \"application/x-octet-stream\" }),\n\t\t\tfilename\n\t\t);\n\n\t\tconst xhttp = new XMLHttpRequest();\n\t\txhttp.open(\"POST\", \"https://file.io\", true);\n\n\t\txhttp.onprogress = e => {\n\t\t\tif (e.lengthComputable) {\n\t\t\t\tonProgress && onProgress(e.loaded / e.total);\n\t\t\t} else {\n\t\t\t\tonProgress && onProgress(0.1);\n\t\t\t}\n\t\t};\n\t\txhttp.onerror = () => {\n\t\t\tresolve({\n\t\t\t\tresult: \"error\",\n\t\t\t\tmessage:\n\t\t\t\t\t\"An error occured. This may be because you do not have internet access or because the file.io servers were unreachable.\"\n\t\t\t});\n\t\t};\n\t\txhttp.onreadystatechange = () => {\n\t\t\tif (xhttp.readyState === 4) {\n\t\t\t\tonProgress && onProgress(1);\n\t\t\t\t// Typical action to be performed when the document is ready:\n\t\t\t\tif (xhttp.response) {\n\t\t\t\t\tconst result: UploadResult = JSON.parse(xhttp.response);\n\t\t\t\t\tif (!result.success) {\n\t\t\t\t\t\tresolve({\n\t\t\t\t\t\t\tresult: \"error\",\n\t\t\t\t\t\t\tmessage: `The file could not be uploaded. Error: ${\n\t\t\t\t\t\t\t\tresult.message\n\t\t\t\t\t\t\t}`\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve({ result: \"success\", url: result.link });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\txhttp.send(formdata);\n\t});\n}\n\nexport function downloadShortcut(\n\tid: string,\n\tonProgress?: (percent: number) => void\n): Promise<\n\t| { result: \"success\"; shortcut: ArrayBuffer }\n\t| { result: \"error\"; message: string }\n> {\n\treturn new Promise(resolve => {\n\t\tconst xhttp = new XMLHttpRequest();\n\t\txhttp.open(\n\t\t\t\"GET\",\n\t\t\t`https://shortcutsweb.app/inspectshortcut?id=${encodeURIComponent(\n\t\t\t\tid\n\t\t\t)}`,\n\t\t\ttrue\n\t\t);\n\t\txhttp.responseType = \"arraybuffer\";\n\n\t\txhttp.onprogress = e => {\n\t\t\tif (e.lengthComputable) {\n\t\t\t\tonProgress && onProgress(e.loaded / e.total);\n\t\t\t} else {\n\t\t\t\tonProgress && onProgress(0.1);\n\t\t\t}\n\t\t};\n\t\txhttp.onerror = () => {\n\t\t\tresolve({\n\t\t\t\tresult: \"error\",\n\t\t\t\tmessage:\n\t\t\t\t\t\"An error occured. This may be because you do not have internet access or because the shortcutsweb.app servers are unreachable.\"\n\t\t\t});\n\t\t};\n\t\txhttp.onreadystatechange = () => {\n\t\t\tif (xhttp.readyState === 4) {\n\t\t\t\tonProgress && onProgress(1);\n\t\t\t\t// Typical action to be performed when the document is ready:\n\t\t\t\tif (xhttp.response) {\n\t\t\t\t\tconst result: ArrayBuffer = xhttp.response;\n\t\t\t\t\tif (xhttp.status === 200) {\n\t\t\t\t\t\treturn resolve({ result: \"success\", shortcut: result });\n\t\t\t\t\t}\n\t\t\t\t\treturn resolve({\n\t\t\t\t\t\tresult: \"error\",\n\t\t\t\t\t\tmessage: `There was an error getting your shortcut data. Maybe you entered the wrong URL? Additional information: Error ${\n\t\t\t\t\t\t\txhttp.status\n\t\t\t\t\t\t}: ${xhttp.statusText}: ${Buffer.from(result).toString(\n\t\t\t\t\t\t\t\"utf-8\"\n\t\t\t\t\t\t)}`\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\txhttp.send();\n\t});\n}\n"]},"metadata":{},"sourceType":"module"}